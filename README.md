# AIStockMonitor 开发文档

## 1. 项目背景

为了便于及时掌握商城内重点商品的库存情况，降低断货风险，现需开发一套自动化库存监控系统 **AIStockMonitor**。
该系统可定时访问指定商城网站，自动检测目标商品库存数量；当库存低于设定阈值时，自动通过 Telegram Bot 向相关人员推送预警通知，实现无人值守的智能库存监控。

---

## 2. 主要功能

### 2.1 商品信息爬取
* 支持定时访问指定商城网站，获取商城网站内的所有商品。
* 创建文件和函数名字，具体功能暂不实现，等待后续开发。

### 2.2 自定义检测间隔

* 检测时间间隔支持自定义，最小单位为分钟。
* 支持灵活配置：如每隔10分钟、每小时等。
* 创建文件和函数名字，具体功能暂不实现，等待后续开发。

### 2.3 库存预警提醒

* 每个商品可单独设置库存阈值。
* 当库存数量小于阈值时，自动触发预警提醒。
* 避免重复提醒：可设置提醒冷却时间，防止同一库存短时内多次推送。
* 创建文件和函数名字，具体功能暂不实现，等待后续开发。

### 2.4 Telegram Bot 消息推送

* 对接 Telegram Bot API，自动向指定用户发送库存预警消息。
* 消息内容可自定义，默认包括商品名、当前库存、阈值、商品链接等信息。
* 首次启动Telegram Bot 后向主人发送一条消息。
* 创建文件和函数名字，具体功能暂不实现，等待后续开发。


---

## 3. 包管理与环境规范（uv - Astra）

- **开发环境：**
  - 电脑系统：Windows 11
  - IDE：PyCharm 2025.1.1
- **统一规范：** 本项目必须使用 [`uv` (Astra)](https://github.com/astral-sh/uv) 作为 Python 包管理和虚拟环境管理工具。
- **开发、测试、部署：** 所有依赖和虚拟环境操作均通过 `uv` 完成，严禁混用 pip、conda、poetry 等工具。
- **依赖管理：**
  - 项目初始化：`uv init`
  - 添加依赖：`uv add <包名>`
  - 锁定依赖：`uv lock`
  - 本地环境同步：`uv sync`
  - 环境导出：`uv export`
- **Python版本要求：**
  - Python 版本：>=3.10，建议 3.12+
  - 建议通过 `uv python` 管理和切换所需的 Python 解释器版本。

---

## 4. 技术选型建议

* **爬虫/数据采集**：requests/httpx、lxml/BeautifulSoup
* **任务调度**：APScheduler
* **消息推送**：python-telegram-bot
* **配置文件**：使用 TOML 文件
* **日志与监控**：标准 logging，必要时集成 Sentry/Prometheus

---

## 5. 关键流程简述

1. **初始化系统配置（商品列表、检测参数、Telegram 信息等）**
2. **定时任务调度，自动采集商品库存数据**
3. **判断库存阈值，是否触发预警**
4. **通过 Telegram Bot 推送库存预警消息**
5. **记录监控日志，支持未来问题追溯与扩展**


---